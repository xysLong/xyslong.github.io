{{ define "main" }}

<style>
.lab-intro-wrapper {
    max-width: 1000px;
    margin: 3rem auto;
    padding: 0 1rem;
}

.lab-intro-header {
    text-align: left;
    margin-bottom: 2rem;
}

.lab-intro-header h1 {
    font-size: 1.75rem;
    margin-bottom: 0.3rem;
    color: #222;
}

.lab-intro-header h2 {
    font-size: 1.25rem;
    color: #555;
}

.lab-intro-content {
    display: grid;
    grid-template-columns: 1fr 250px;
    gap: 2rem;
    align-items: start;
}

.lab-intro-text p {
    font-size: 1rem;
    line-height: 1.6;
    color: #444;
}

.lab-intro-logo {
    text-align: center;
}

.lab-intro-logo img {
    max-width: 100%;
    max-height: 180px;
    object-fit: contain;
}

/* Responsive */
@media (max-width: 768px) {
    .lab-intro-content {
        grid-template-columns: 1fr;
        text-align: center;
    }

    .lab-intro-text p {
        text-align: left;
        margin-top: 1rem;
    }
}
</style>

<div class="lab-intro-wrapper">
    <div class="lab-intro-header">
        <h1>Lab for Cognitive Research in Art History (CReA)</h1>
        <h2>University of Vienna</h2>
    </div>
    <div class="lab-intro-content">
        <div class="lab-intro-text">
            <p>
                The aim of the CReA lab is to expand art historical knowledge through the use of empirical and experimental methods.
                The laboratory's projects deal with traditional art historical questions about artworks and their perception as well as transdisciplinary issues of empirical aesthetics, visual culture and museology.
            </p>
        </div>
        <div class="lab-intro-logo">
            <img src="/images/crealab/crea_logo.png" alt="CReA Logo">
        </div>
    </div>
</div>


<style>
    .lab-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 2rem;
        justify-items: center;
    }

    .lab-member {
        width: 220px;
        text-align: center;
        transition: color 0.3s ease;
    }

    .lab-member a {
        text-decoration: none;
        color: black;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .lab-member img {
        width: 160px;
        height: 160px;
        border-radius: 50%;
        object-fit: cover;
        margin-bottom: 0.6rem;
        transition: transform 0.3s ease;
    }

    .lab-member h3 {
        color: #2daa68;
        margin: 0.2rem 0 0.2rem;
        font-size: 1rem;
        transition: color 0.3s ease;
    }

    .lab-member p {
        font-size: 0.8rem;
        margin: 0;
        transition: color 0.3s ease;
    }

    .lab-member:hover h3,
    .lab-member:hover p {
        color: #0066cc;
    }

    .lab-member:hover img {
        transform: scale(1.1);
    }

    @media (max-width: 768px) {
        .lab-grid {
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        }

        .lab-member {
            width: 180px;
        }

        .lab-member img {
            width: 110px;
            height: 110px;
        }
    }

    .lab-section-title {
        font-size: 1.2rem;
        margin-top: 3rem;
        margin-bottom: 3rem;
        text-align: center;
    }
</style>

{{ $all := site.Data.crealab.people }}
{{ $statuses := slice "Main" "Associated" "Student" }}
{{ $titles := dict "Main" "Lab Members" "Associated" "Associated Researchers and Former Members" "Student" "Master Candidates"}}
{{ $namesAtTop := slice "Raphael Rosenberg" "Teresa Kamencek" "Luise Reitst√§tter" }}

{{ range $status := $statuses }}
<h2 class="lab-section-title">{{ index $titles $status }}</h2>
<section class="lab-grid" id="lab-{{ $status | urlize }}">

    {{ range (where $all "status" $status) }}
    {{ $isAtTop := partial "not_randomized.html" (dict "name" .name "names" $namesAtTop) }}
    {{ $isExternal := ne .name "Xingyu Long" }}
    <div class="lab-member" data-is-at-top="{{ $isAtTop }}">
        <a href="{{ .website }}" {{ if $isExternal }}target="_blank" rel="noopener"{{ end }}>
            <img src="/images/crealab/{{ .photo }}" alt="{{ .name }}">
            <h3>{{ .name }}</h3>
            <p>{{ .focus }}</p>
        </a>
    </div>
    {{ end }}

</section>
{{ end }}

<script>
    document.querySelectorAll('.lab-grid').forEach(section => {
        const items = Array.from(section.children);
        const atTopItems = items.filter(item => item.dataset.isAtTop === "true");
        const notAtTopItems = items.filter(item => item.dataset.isAtTop === "false");

        for (let i = notAtTopItems.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [notAtTopItems[i], notAtTopItems[j]] = [notAtTopItems[j], notAtTopItems[i]];
        }

        section.innerHTML = '';
        atTopItems.forEach(el => section.appendChild(el));
        notAtTopItems.forEach(el => section.appendChild(el));
    });

</script>

{{ end }}
